# C# Utilities

This project includes C# utilities for working with LDIF diffs, eliminating the need for external dependencies.

## LdifDiffDemo (Main Tool)

The primary LDIF comparison and analysis tool.

### Comparison Mode
```bash
# Text format output
dotnet run --project LdifDiffDemo/LdifDiffDemo.csproj -- \
  --compare baseline.ldif new.ldif --output diff.txt

# JSONL format output (recommended for parsing)
dotnet run --project LdifDiffDemo/LdifDiffDemo.csproj -- \
  --compare baseline.ldif new.ldif --output diff.jsonl
```

### Analysis Mode
```bash
# Analyze single LDIF file
dotnet run --project LdifDiffDemo/LdifDiffDemo.csproj -- \
  input.ldif output.jsonl
```

## LdifDiffAnalyzer

Parse and analyze JSONL diff files generated by the comparison tool.

### Usage

```bash
# Summary report (default)
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl

# Show specific reports
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl --added
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl --removed
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl --modified

# Show all reports
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl --all

# Find entries matching pattern
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl --find "user01"

# Export to CSV
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl --csv output.csv

# Combine options
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- \
  diff.jsonl --all --find "engineering" --csv report.csv
```

### Features

- **Summary Reports**: Count of added/removed/modified entries
- **Detailed Analysis**: View sample entries with operations and attribute counts
- **Pattern Matching**: Find entries by DN pattern
- **CSV Export**: Export diffs to CSV for Excel/database import
- **Efficient**: Streams large JSONL files without loading entire file into memory

## LdifTestGenerator

Generate large test LDIF files for testing and performance benchmarking.

### Usage

```bash
# Generate all test files
dotnet run --project LdifTestGenerator/LdifTestGenerator.csproj
```

### Generated Files

1. **baseline_large.ldif** - 5,000 entries (baseline reference)
2. **similar_large.ldif** - 5,000 entries + 100 mods (2% change, should PASS validation)
3. **different_large.ldif** - 6,500 entries (30% increase, should FAIL validation)
4. **complex_operations.ldif** - 2,867 operations (mix of add/modify/delete)
5. **very_large.ldif** - 25,000 entries (stress test)

### Features

- **Deterministic**: Uses fixed random seed for reproducible test data
- **Fast**: Generates 25,000 entries in ~1 second
- **Realistic**: Includes proper LDAP attributes and structures

## Example Workflow

### 1. Compare Two LDIF Files

```bash
# Generate JSONL diff
dotnet run --project LdifDiffDemo/LdifDiffDemo.csproj -- \
  --compare baseline.ldif new.ldif --output diff.jsonl
```

### 2. Analyze the Differences

```bash
# View summary
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- diff.jsonl

# Find specific users
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- \
  diff.jsonl --find "ou=Engineering"

# Export for reporting
dotnet run --project LdifDiffAnalyzer/LdifDiffAnalyzer.csproj -- \
  diff.jsonl --csv diff-report.csv
```

### 3. Generate Test Data

```bash
# Create test files
dotnet run --project LdifTestGenerator/LdifTestGenerator.csproj

# Test with generated files
dotnet run --project LdifDiffDemo/LdifDiffDemo.csproj -- \
  --compare test-data/baseline_large.ldif test-data/similar_large.ldif \
  --output test-diff.jsonl
```

## JSONL Format

The JSONL (JSON Lines) format used for diff output:

```json
{
  "dn": "cn=User01,OU=Users,DC=example,DC=com",
  "changeType": "Added",
  "baselineOperations": null,
  "newOperations": ["Add", "Modify"],
  "baselineAttrCount": null,
  "newAttrCount": 7,
  "attributeDifferences": [
    "  + objectClass: 1 value(s)",
    "  + cn: 1 value(s)",
    "  + mail: 2 value(s)"
  ]
}
```

### Benefits

- **One entry per line**: Easy to stream and process
- **Standard JSON**: Parse with any JSON library
- **Human-readable**: Can be inspected with text tools
- **Efficient**: Doesn't require loading entire file into memory

## Integration

All utilities are standalone C# console applications that can be:
- Run directly with `dotnet run`
- Published as executables: `dotnet publish -c Release`
- Integrated into CI/CD pipelines
- Called from shell scripts or other applications

## Dependencies

- .NET 8.0+ (main project)
- .NET 10.0+ (analyzer and generator projects)
- LdifHelper NuGet package (LDIF parsing)
- System.Text.Json (built-in)

No external Python, Node.js, or other runtime dependencies required.
